<!-- group_skills.html -->
{% extends "base.html" %}
{% load static %}

{% block title %}مهارات المجموعة — {{ group.name }} — {{ child.username }}{% endblock %}

{% block extra_head %}
<style>
  body{font-family:Tahoma,Arial;background:#f7f9fc}
  .page-wrap{padding:24px}
  h2{margin:0 0 6px}
  .sub{color:#667085;margin:0 0 16px}
  table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.06)}
  th,td{padding:10px;border-bottom:1px solid #eee;text-align:center}
  th{background:#f1f3f8}
  .tag{padding:4px 8px;border-radius:999px;font-size:12px;color:#fff;display:inline-block}
  .w{background:#e74a3b}            /* تحتاج تحسين */
  .g{background:#f1c40f;color:#222}  /* جيدة */
  .s{background:#2ecc71}            /* قوية */
  a.btn{background:#4e73df;color:#fff;padding:6px 10px;border-radius:8px;text-decoration:none}
</style>
{% endblock %}

{% block content %}
<div class="page-wrap">

  <h2>مهارات المجموعة: {{ group.name }} — {{ child.username }}</h2>
  {% if session %}
    <p class="sub">
      جلسة #{{ session.id }} —
      من {{ session.started_at|date:"Y-m-d H:i" }}
      إلى {{ session.ended_at|date:"Y-m-d H:i" }}
      — الحالة: {{ session.get_status_display }}
    </p>
  {% else %}
    <p class="sub">بدون تحديد جلسة (إجمالي جميع الجلسات)</p>
  {% endif %}

  <table>
    <thead>
      <tr>
        <th>المهارة</th>
        <th>الدقة</th>
        <th>الانتباه</th>
        <th>ص/غ</th>
        <th>الحالة</th>
        <th>تفاصيل</th>
      </tr>
    </thead>
    <tbody>
      {% for s in skills %}
        <tr>
          <td>{{ s.skill_name }}</td>
          <td>{{ s.accuracy_pct }}%</td>
          <td>{{ s.attention_pct }}%</td>
          <td>{{ s.counts.correct }}/{{ s.counts.total }}</td>
          <td>
            {% if s.level == 'needs_improvement' %}
              <span class="tag w">تحتاج تحسين</span>
            {% elif s.level == 'strong' %}
              <span class="tag s">قوية</span>
            {% else %}
              <span class="tag g">جيدة</span>
            {% endif %}
          </td>
          <td>
            <a class="btn"
               href="{% url 'skill_detail' child.id s.skill_id %}{% if session %}?session_id={{ session.id }}{% endif %}">
              فتح
            </a>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="6">لا توجد بيانات لهذه المجموعة.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="margin-top:12px">
    <a class="btn" href="{% url 'child_skills_overview' child.id %}{% if session %}?session_id={{ session.id }}{% endif %}">
      &larr; رجوع إلى النظرة العامة
    </a>
  </p>

</div>
{% endblock %}
